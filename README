Not secure yet
Assumes shadow defined
