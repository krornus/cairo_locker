Not secure yet, assumes shadow defined
